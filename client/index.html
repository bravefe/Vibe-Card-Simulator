<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Card Table</title>
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="controls">
        <form id="uploadForm" enctype="multipart/form-data">
            <label for="deckName">Deck Name:</label>
            <input type="text" id="deckName" name="deckName" required>

            <label for="deckImages">Create a Deck:</label>
            <input type="file" id="deckImages" name="deckImages" multiple required>

            <label for="cardBack">Card Back:</label>
            <input type="file" id="cardBack" name="cardBack" accept=".png,.jpg,.jpeg,.webp">

            <button type="submit">Upload Deck</button>
        </form>
    </div>

    <div id="buttons-container">
        <button id="cretePileBtn" type="button">Create Pile</button>
        <button id="deckAddModeBtn" type="button">Add card to bottom deck</button>
    </div>

    <div id="deck-menu" class="closed"></div>

    <div id="game-board">
        <!-- Decks and cards will be added here dynamically by JavaScript -->
    </div>

    <div id="card-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); justify-content:center; align-items:center; z-index:9999;">
        <img id="modal-img" src="" style="max-width:90vw; max-height:90vh; border-radius:12px; box-shadow:0 0 20px #000;">
    </div>

    <!-- Deck Search Modal -->
    <div id="deck-search-modal" style="display:none; position:absolute; background:#fff; border-radius:8px; box-shadow:0 2px 12px #0008; padding:10px; z-index:3000; min-width:200px;">
        <div id="deck-search-list" style="max-height:300px; overflow-y:auto;"></div>
        <button id="deck-search-close" style="margin-top:8px;">Close</button>
    </div>

    <!-- Toggle Button for Deck Menu -->
    <button id="deck-menu-toggle">
        <img src="assets/deck-icon.png" alt="Deck Menu">
    </button>

    <button id="library-toggle">
        <img src="assets/lib-icon.png" alt="Library Menu">
    </button>

    <!-- Card Library Modal -->
    <div id="library-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(33,150,243,0.98); z-index:5000; flex-direction:column;">
        <div style="display:flex; flex-direction:row; height:100%;">
            <!-- Sidebar: Game & Pack Selection -->
            <div id="library-sidebar" style="width:260px; background:#fff; box-shadow:2px 0 12px #0003; padding:18px 10px; overflow-y:auto;">
                <h2 style="margin-top:0;">Games</h2>
                <div id="library-game-list"></div>
                <h3>Packs/Folders</h3>
                <div id="library-pack-list"></div>
            </div>
            <!-- Main: Card Grid -->
            <div style="flex:2; display:flex; flex-direction:column;">
                <h2 style="color:#fff; margin:18px 0 0 18px;">Card Library</h2>
                <div id="library-card-grid" style="flex:1; display:grid; grid-template-columns:repeat(auto-fill,120px); gap:16px; padding:18px; overflow-y:auto;"></div>
            </div>
            <!-- Deck Builder -->
            <div id="library-deck-builder" style="width:340px; background:#f5f5f5; box-shadow:-2px 0 12px #0003; padding:18px 10px; overflow-y:auto; display:flex; flex-direction:column;">
                <h2 style="margin-top:0;">Deck Builder</h2>
                <div id="library-deck-list"></div>
                <div style="margin-top:18px;">
                    <label for="library-deck-name">Deck Name:</label>
                    <input type="text" id="library-deck-name" style="width:80%; margin-bottom:8px;">
                </div>
                <div style="margin-bottom:12px;">
                    <label for="library-card-back">Card Back:</label>
                    <input type="file" id="library-card-back" accept=".png,.jpg,.jpeg,.webp">
                    <div id="card-back-preview" style="display:none; margin-top:8px; text-align:center;">
                        <img id="card-back-preview-img" style="width:100px; height:140px; object-fit:cover; border-radius:8px; border:1px solid #bbb; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">
                    </div>
                </div>
                <button id="library-save-btn" style="margin-bottom:10px;">Save Deck</button>
                <button id="library-exit-btn">Exit</button>
            </div>
        </div>
    </div>

    <button id="show-shortcuts-btn" title="Show Keyboard Shortcuts">â˜°</button>

    <div id="keyboard-shortcuts">
        <h1>Key-Shortcuts</h1>
        <b>1-9:</b> chose layer<br>
        <b>F:</b> flipcard<br>
        <b>R:</b> rotate card<br>
        <b>D:</b> draw card facedown<br>
        <b>E:</b> hide card to other player<br>
    </div>

    <!-- Libraries -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <!-- Your Game Logic -->
    <script src="client.js"></script>
</body>
</html>